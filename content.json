{"meta":{"title":"大坑的博客","subtitle":"Kids， your road is：码畜→BUG→码狗→BUG→码农→BUG→搬砖工，Then you DIE！","description":null,"author":"Dakeng","url":"http://yoursite.com"},"pages":[],"posts":[{"title":"Test","slug":"病原体微生物流程–v1版本：kraken-kaiju (1)","date":"2018-06-05T06:16:17.997Z","updated":"2018-06-05T09:22:40.018Z","comments":true,"path":"2018/06/05/病原体微生物流程–v1版本：kraken-kaiju (1)/","link":"","permalink":"http://yoursite.com/2018/06/05/病原体微生物流程–v1版本：kraken-kaiju (1)/","excerpt":"","text":"病原体微生物流程–v1版本：kraken-kaiju@(流程)[病原体|微生物|] 流程介绍 病原体微生物检测： 该流程分析脑脊液宏基因组样本，鉴定其中病原体，该病原体可能为：病毒、细菌、真菌、寄生虫。鉴定过程主要利用kraken 与 kaiju两个软件，本流程基于liuyan推荐的文章搭建：Oxford Screening CSF and Respiratory samples (‘OSCAR’): results of a pilot study to screen clinical samples from a diagnostic microbiology laboratory for viruses using Illumina next generation sequencing（https://link.springer.com/article/10.1186%2Fs13104-018-3234-8） 数据库简介 ：数据库简介； Step1 -QC ：去除低质量数据，剔除宿主–人类reads，并统计； Step2 -Classify ：利用kraken与kaiju将测序reads比对到数据库； 其它：metaphlan2，megablast、Surpi_tm 一、数据库简介 鉴定病原体过程利用kraken与kaiju两个工具。kraken为DNA序列的鉴定工具（http://ccb.jhu.edu/software/kraken/MANUAL.html#introduction）其利用的数据库为微生物基因组，所有参考基因组都来自NCBI reference 数据库，地址为：ftp://ftp.ncbi.nlm.nih.gov/genomes/refseq/，包括 Bacteria：113597种，路径：/Bioinfo/Database/Pathogen_reference/Reference_genome_fasta/Bacteria/ Virus：7564种，路径/Bioinfo/Database/Pathogen_reference/Reference_genome_fasta/Virus Funji 254种，路径/Bioinfo/Database/Pathogen_reference/Reference_genome_fasta/Funji Archaea 707种，路径/Bioinfo/Database/Pathogen_reference/Reference_genome_fasta/Archaea Parasite 11种，只下载了文献中提到的寄生虫 /Bioinfo/Database/Pathogen_reference/Reference_genome_fasta/Parasite Kaiju为蛋白质序列的鉴定工具（http://kaiju.binf.ku.dk/），该工具所用的数据库是可选择的：Kaiju can use either the set of available complete genomes from NCBI RefSeq or the microbial subset of the NCBI BLAST non-redundant protein database nr, optionally also including fungi and microbial eukaryotes，目前使用的是NCBI BLAST nr +euk103M protein sequences from nr: Bacteria, Archaea, Viruses, Fungi and microbial eukaryotes. 路径 /Bioinfo/Database/Pathogen_reference/Kaiju_download_database/ ####二、Step1 Step1，主要为QC过程，首先利用fastqc、trimmomatic去除低质量reads；然后利用Soapalign或bwa将reads比对到hg19基因组上，最后对质控过程进行统计，生成统计文件*.log，目前集成脚本Step_Qc_v0.py，该脚本路径：/Bioinfo/MDDRD2/PMO/jianglk/Pathogen_pipeline/Pipeline_kraken_kaiju/Step_1_Qc/Steq_Qc_v0.py，其中soap和bwa两个比对软件（将reads比对到hg19）是可选的。12345678910111213141516171819202122$ python3 Steq_Qc_v0.py -husage: Steq_Qc_v0.py [-h] --name NAME --adapter ADAPTER --fastq1 FASTQ1 --fastq2 FASTQ2 --outdir OUTDIR --statlog STATLOG --software SOFTWARE***Pathogen Analysis Step one --QC***optional arguments: -h, --help show this help message and exit --name NAME, -n NAME 样本名称 --adapter ADAPTER, -a ADAPTER adapter file --fastq1 FASTQ1, -f1 FASTQ1 测序数据 fastq1 --fastq2 FASTQ2, -f2 FASTQ2 测序数据 fastq2 --outdir OUTDIR, -o OUTDIR Qc directory --statlog STATLOG, -l STATLOG 统计log文件 --software SOFTWARE, -s SOFTWARE 使用bwa 或者 soap，此处输入bwa或者soap bwa 与 soap 目前质控过程中reads 比对hg19的软件是可选的，soap 或者 bwa，两个软件比对结果差异还是挺大的。之后会利用RNA-seq流程验证确定哪个软件更好。 12345678910111213BWARaw_data_size_fq1 770.18MbRaw_data_size_fq2 770.18MbRaw_data_reads_fastq1 10034692Raw_data_reads_fastq2 10034692Clean_data_reads_fastq1 3344744Clean_data_reads_fastq2 3344744Host_reads_fastq1 1065157Host_reads_fastq2 1062622Used_reads_fastq1 2279587Used_reads_fastq2 2282122Used_ratio_fastq1 0.2271705997553288Used_ratio_fastq2 0.2274232233535419 12345678910111213SoapRaw_data_size_fq1 770.18MbRaw_data_size_fq2 770.18MbRaw_data_reads_fastq1 10034692Raw_data_reads_fastq2 10034692Clean_data_reads_fastq1 3344744Clean_data_reads_fastq2 3344744Host_reads_fastq1 357962Host_reads_fastq2 347512Used_reads_fastq1 2986782Used_reads_fastq2 2997232Used_ratio_fastq1 0.29764560785722Used_ratio_fastq2 0.29868699507668 ####二、Step2 Step2，病原体鉴定过程，利用kraken 与 kaiju 两个工具，目前集成脚本Step_kraken_kaiju.py，该脚本路径：/Bioinfo/MDDRD2/PMO/jianglk/Pathogen_pipeline/Pipeline_kraken_kaiju/Step_2_kraken_kaiju/Step_kraken_kaiju.py，需要输入的是Step1中过滤低质量、宿主reads之后的 clean reads，目前测试结果可参照：/Bioinfo/MDDRD2/PMO/jianglk/Pathogen_pipeline/Pipeline_kraken_kaiju/Step_2_kraken_kaiju/classify_report.txt -注意 因服务器内存原因，目前kraken使用数据库只占总数据库的1/3，造成该流程鉴定结果不准确，因此目前流程没有测试意义。 123456789101112131415161718$ python3 Step_kraken_kaiju.py -husage: Step_kraken_kaiju.py [-h] --fastq1 FASTQ1 --fastq2 FASTQ2 --kraken_database KRAKEN_DATABASE --name NAME --outdir OUTDIR***Use kraken and kaiju to identify reads !***optional arguments: -h, --help show this help message and exit --fastq1 FASTQ1, -fq1 FASTQ1 clean fastq1 reads --fastq2 FASTQ2, -fq2 FASTQ2 clean fastq2 reads --kraken_database KRAKEN_DATABASE, -kd KRAKEN_DATABASE Kraken database --name NAME, -n NAME sample name --outdir OUTDIR, -o OUTDIR runout dirctory ####三、其它 测试样本：目前三个测试样本为脑炎患者脑脊液RNA测序样本，来自文献：Identification of Viruses in Cases of Pediatric Acute Encephalitis and Encephalopathy Using Next-Generation Sequencing Metaphan2 一种微生物鉴定工具，应用于人类微生物组计划，用于物种鉴定，肠道、皮肤、阴道等等，医学应用未见报道。该工具的分析结果见： /Bioinfo/MDDRD2/PMO/jianglk/Pathogen_pipeline/Analysis/metaphlan2 megablast 略，还未分析 Surpi_tm 略，因服务器配置不能达到分析要求，也尚未分析","categories":[],"tags":[]},{"title":"Hello World","slug":"hello-world","date":"2018-06-05T05:36:00.335Z","updated":"2018-06-05T05:36:00.335Z","comments":true,"path":"2018/06/05/hello-world/","link":"","permalink":"http://yoursite.com/2018/06/05/hello-world/","excerpt":"","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new \"My New Post\" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment","categories":[],"tags":[]}]}